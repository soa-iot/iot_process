<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>问题评估转交其他执行人</title>
	<link href="/package/zTree/zTreeStyle.css" rel="stylesheet" type="text/css" rel="stylesheet"/>
</head>
<body>
	<!-- html部分 -->
	<div>
		 <ul id="tree" class="ztree" style="width:230px; overflow:auto;"></ul>
	</div>
	
	<!-- js部分 -->
	<script src="/package/jquery-3.3.1/jquery-3.3.1.min.js" type="text/javascript" ></script>
	<script src="/package/zTree/jquery.ztree.all-3.5.js" type="text/javascript" ></script>
	<script src="/package/zTree/jquery-migrate.min.js"></script>
	<script src="/package/own/universal.js" type="text/javascript" ></script>
	<script src="/javaScript/project.js" type="text/javascript" ></script>
	<script type="text/javascript" >
		/**
		 * 参数定义
		 */
		 //当前选择节点名称
		 var currTreeNodeName = "",
		 //问题评估节点参数url
		 	 treeNodePEUrl =  ipPort + "/problemEstimate/exector";
		 //tree参数设置
		 var setting={
            check: {
                enable: true,
                chkStyle : "radio"//显示 checkbox 选择框，默认checkbox可选择值radio
            },
            callback:{
                onCheck : zTreeOnCheck
            },
            data: {
	            	key: {
	    				isParent: "isParent"
    				},
	        		simpleData : {
	        			enable : true,
	        			idKey : "id",
	        			pIdKey : "pid",
	        			rootPId : 0
        			}
        			
        	}

        };
		//tree内容设置
		var zTreeNodes = [];
	    
		 /**
		  * 页面初始化
		  */
		$(function(){
			console.log( 'tree页面初始化…… ' );
			
			//ajax请求节点内容
			var parentId = "0";
			ajaxByGet( treeNodePEUrl + "/" + parentId , {} , executorGetFunction, false );
			
			//tree初始化
			var city = $.fn.zTree.init( $("#tree"), setting, zTreeNodes );
		})
		   
		/**
		 * zTree节点-单击事件
		 */   
		function zTreeOnCheck( event, treeId, treeNode ) {
			console.log( 'zTree节点-单击事件…… ' );
			currTreeNodeName =  treeNode.name ;
		}
		 
		/**
		 * 获取参数currTreeNodeName值
		 */
		function getCurrTreeNodeName(){
			 console.log( '获取参数currTreeNodeName值…… ' );
			 return currTreeNodeName;
		}
		 
		/**
		 * 初始化请求人员组织-回调函数
		 */
		function executorGetFunction( jsonData ){
			console.log( '初始化请求人员组织-回调函数…… ' );
			if( jsonData ){
				var data = jsonData.data;
				console.log( data );
				if( jsonData.state == 0 && data ){
					zTreeNodes = data;
				}else{
					layer.msg('保存失败：' + jsonData.message, {icon: 4});
				}
			}else {
				layer.msg('请求失败', {icon: 6});
			}	
		}
	</script>
</body>
</html>