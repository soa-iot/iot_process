<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>完成作业</title>
<link rel="stylesheet" href="../jsPackage/layui-v2.4.2/css/layui.css" media="all">
<link rel="stylesheet" href="../css/estimate.css" media="all">
<link rel="stylesheet" href="../css/report.css" media="all">
<script type="text/javascript" src="../js/report-publishImg.js"></script>
<style type="text/css">
	
</style>
</head>
<body>

	<!-- 完成作业 -->
	<div class="pro-div">

		<!-- 问题处理 -->
		<div class="layui-collapse" lay-accordion="">
			<div class="layui-colla-item">
				<h2 class="layui-colla-title h2c" id="pro">问题处理</h2>
				
				<div class="hbtn h2c">
					<button class="layui-btn layui-btn-normal layui-btn-sm btn problem_describe">完成作业</button>
				</div>
				<div class="layui-colla-content layui-show">
	
					<div class="layui-form-item">
						<div class="layui-inline">
							<label class="layui-form-label labelr">现场施工图</label>
							<div class="layui-input-inline layui-input-top">
								<!-- 多图片上传 -->
			                    <button type="button" class="layui-btn layui-btn-sm" id="addFinishImg">选择上传图片</button> 
							</div>
						</div>
					</div>
					
					<div class="layui-form-item" style="display: none;" id="finish-phos">
						<div class="layui-inline">
							<label class="layui-form-label labelr">&nbsp;</label>
							<div class="layui-input-inline">
								<ul id="imgZmList"></ul>
							</div>
						</div>
					</div>
				
					<div class="layui-inline">
						<label class="layui-form-label labelr">事件/隐患标记</label>
						<div class="layui-input-inline layui-input-top">
							<select class="layui-input  layui-input-one" name="modules"
								lay-verify="required" >
								<option value="">其他</option>
								<option value="1">事故事件</option>
								<option value="2">隐患事件</option>
							</select>
						</div>
					</div>
					
					<div class="layui-form-item">
						<div class="layui-inline">
							<label class="layui-form-label labelr">整改日期</label>
							<div class="layui-input-inline layui-input-top">
								<select id="sele" class="layui-input layui-input-one" name="modules"
								lay-verify="required" lay-search="">
								<option value="setdate">指定日期</option>
								<option value="overhaul">大修时整改</option>
							</select>
							</div>
						</div>
						<div class="layui-inline">
							<label class="layui-form-label">指定日期</label>
							<div class="layui-input-inline  layui-input-top">
								<input type="text" class="layui-input layui-input-one" id="sdate"
									placeholder="yyyy-MM-dd">
							</div>
						</div>
					</div>

					<div class="layui-form-item layui-form-text">
						<label class="layui-form-label">处理说明</label>
						<div class="layui-input-block right-marg">
							<textarea name="title" id="input_localName" placeholder="请输入内容"
								class="layui-textarea" name="desc">250-GT-115分析化验one</textarea>
						</div>
					</div>

					<div>
						<label class="layui-form-label">处理过程</label>
						<div class="layui-input-block right-marg">
							<table class="layui-table layui-input-block tdp">
								<colgroup>
									<col width="150">
									<col width="150">
									<col width="200">
									<col  width="200">
								</colgroup>
								<thead>
									<tr>
										<th>处理人</th>
										<th>处理节点</th>
										<th>操作</th>
										<th>处理说明</th>
										<th>时间</th>
									</tr>
								</thead>
								<tbody>
									<tr>
										<td></td>
										<td></td>
										<td></td>
										<td></td>
										<td></td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>

				</div>

			</div>
		</div>

		<!-- 问题信息 -->
		<div class="layui-collapse" lay-filter="test">
			<div class="layui-colla-item">
				<h2 class="layui-colla-title h2c">问题信息</h2>
				<div class="layui-colla-content">

					<div class="layui-form-item">
						<div class="layui-inline">
							<label class="layui-form-label">上&nbsp;报&nbsp;人</label>
							<div class="layui-input-inline layui-input-top">
								<input id="applypeople" type="text"
									class="layui-input layui-input-one" disabled="disabled">
							</div>
						</div>
						<div class="layui-inline">
							<label class="layui-form-label">属地单位</label>
							<div class="layui-input-inline layui-input-top">
								<input type="text" id="problemtype"
									class="layui-input  layui-input-one" disabled="disabled">
							</div>
						</div>
					</div>

					<div class="layui-form-item">
						<div class="layui-inline">
							<label class="layui-form-label">问题区域</label>
							<div class="layui-input-inline layui-input-top">
								<input type="text" id="welName" class="layui-input layui-input-one"
									disabled="disabled">
							</div>
						</div>
						<div class="layui-inline">
							<label class="layui-form-label">所属专业</label>
							<div class="layui-input-inline layui-input-top">
								<input type="text" id="prob" 
									class="layui-input  layui-input-one" disabled="disabled">
							</div>
						</div>
					</div>

					<div class="layui-form-item">
						<div class="layui-inline">
							<label class="layui-form-label">设备定位</label>
							<div class="layui-input-inline layui-input-top layui-row">
								<input type="text" id="rfid" class="layui-input layui-input-one" disabled="disabled">
								<!-- <button class="layui-btn layui-btn-xs layui-col-md4 layui-col-md-offset1" style="height: 25px;">定位设备</button> -->
							</div>
				
						</div>
						<div class="layui-inline">
							<label class="layui-form-label">问题类别</label>
							<div class="layui-input-inline layui-input-top">
								<input type="text" id="problemclass" lay-verify="email"
									class="layui-input  layui-input-one" disabled="disabled">
							</div>
						</div>
					</div>

					<div class="layui-form-item layui-form-text">
						<label class="layui-form-label">问题描述</label>
						<div class="layui-input-block right-marg">
							<textarea name="title" id="problem_describe" disabled class="layui-textarea" name="desc"></textarea>
						</div>
					</div>

					<div class="layui-form-item layui-form-text bott">
						<label class="layui-form-label">问题图片</label>
						<div class="layui-input-block">
							<div class="layui-carousel" id="test1" lay-filter="test1">
								<div carousel-item="" id="imag">
									<!--  <div>
									<img alt="图片1" src="../jsPackage/layui-v2.4.2/images/问题上报/u156.png">
									<img alt="图片2" src="../jsPackage/layui-v2.4.2//images/问题上报/u154.png"> 
									<img alt="图片3" src="../jsPackage/layui-v2.4.2//images/问题上报/u152.png">
								</div>
								<div>
									<img alt="图片1" src="../jsPackage/layui-v2.4.2/images/问题上报/u156.png">
									<img alt="图片2" src="../jsPackage/layui-v2.4.2//images/问题上报/u154.png"> 
								</div>
								<div>
									<img alt="图片1" src="../jsPackage/layui-v2.4.2/images/问题上报/u156.png">
								</div>
								<div>
									<img alt="图片1" src="../jsPackage/layui-v2.4.2/images/问题上报/u156.png">
									<img alt="图片2" src="../jsPackage/layui-v2.4.2//images/问题上报/u154.png"> 
									<img alt="图片3" src="../jsPackage/layui-v2.4.2//images/问题上报/u152.png">
								</div>
								<div>
									<img alt="图片1" src="../jsPackage/layui-v2.4.2/images/问题上报/u156.png">
									<img alt="图片2" src="../jsPackage/layui-v2.4.2//images/问题上报/u154.png"> 
									<img alt="图片3" src="../jsPackage/layui-v2.4.2//images/问题上报/u152.png">
								</div>
								<div>
									<img alt="图片1" src="../jsPackage/layui-v2.4.2/images/问题上报/u156.png">
									<img alt="图片2" src="../jsPackage/layui-v2.4.2//images/问题上报/u154.png"> 
									<img alt="图片3" src="../jsPackage/layui-v2.4.2//images/问题上报/u152.png">
								</div>
							</div> -->
									<!-- </div>
						<img alt="图片1" src="../jsPackage/layui-v2.4.2/images/问题上报/u156.png">
							<img alt="图片2" src="../jsPackage/layui-v2.4.2//images/问题上报/u154.png"> 
							<img alt="图片3" src="../jsPackage/layui-v2.4.2//images/问题上报/u152.png">
						</div> -->
								</div>

							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="layui-collapse" lay-accordion="">
			<div class="layui-colla-item">
				<h2 class="layui-colla-title h2c">工单信息</h2>
				<div class="layui-colla-content layui-show">
					<div class="btn-div">
						<button class="layui-btn layui-btn-normal layui-btn-sm pbtn problem_describe">脚手架搭拆申请单</button>
						<button class="layui-btn layui-btn-normal layui-btn-sm pbtn problem_describe">防腐（保温）申请单</button>
					</div>
				</div>
			</div>
		</div>

	</div>
	<script type="text/javascript" src="../jsPackage/js/jquery-1.9.1.min.js"></script>
	<script src="../jsPackage/layui-v2.4.2/layui.js" charset="utf-8"></script>
	<script type="text/javascript" src="../js/estimate.js"></script>
	<script type="text/javascript">
    	//加载layui内置模块
		layui.use(['jquery','form','upload','layedit', 'laydate'], function(){
		  var form = layui.form
		  ,layer = layui.layer
		  ,layedit = layui.layedit
		  ,laydate = layui.laydate
		  ,$ = layui.$ //重点处,使用jQuery
		  ,upload = layui.upload;
		 
		//多图片上传功能
		     var uploadList = upload.render({
		          elem: '#addFinishImg'
		          , url: '#'
		          , data: {		resavepeople: function(){ return resavepeople;}, 
		        	  	   		tProblemRepId: function(){ return uuid;}
		          			}
		          , accept: 'images'
		          , number: 3
		          , multiple: true
		          , auto:false
		          , bindAction: '#saveBtn'
		          , choose: function (obj) {
		        	  
		        	//将每次选择的文件追加到文件队列
		          	var files = this.files = obj.pushFile();
		          	$("#finish-phos").css({"display":"block"});
		          	
		           //预读本地文件，如果是多文件，则会遍历。(不支持ie8/9)
		           obj.preview(function (index, file, result) {
		               console.log(index);
		               // $('#imgZmList').append('<li style="position:relative"><img name="imgZmList" src="' + result + '"width="150" height="113"><div class="title_cover" name="imgZmName" onclick="divClick(this)"></div><div class="img_edit layui-icon" onclick="croppers_pic(this)">&#xe642;</div><div class="img_close" onclick="deleteElement(this)">X</div></li>');
		               $('#imgZmList').append('<li style="position:relative"><img style="margin:0px; height:150px; width:180px;" name="imgZmList" src="' + result + '"><div class="img_close" onclick="deleteElement(this)">X</div></li>');
		               //删除列表中对应的文件
		               $(".img_close").click(function(){
		              	 delete files[index]; //删除对应的文件
		              	 var len = $('#imgZmList').children().length;
		              	 if(len <= 0){
		              		 $("#finish-phos").css("display", "none");
		              	 }
		              	 console.log(index);
		              	 uploadList.config.elem.next()[0].value = ''; //清空 input file值，以免删除后出现同名文件不可选
		               })
		               
		               form.render();
		            });
		          }
		      	   //上传前执行的函数
		          ,before: function(obj){
		    	     
		    	  }
		           //上传完毕后的，回调函数
		          , done: function (res, index, upload) {
		        	 // layer.closeAll('loading'); //关闭loading
		        	  console.log(res);
		        	  if(res.state == 0){
		        		  delete this.files[index];  //删除上传成功的文件
		        	  }else{
		        		 // this.error(index, upload);
		        	  }
		          }
		           //上传失败时，回调函数
		          ,error: function(index, upload){
		        	 // layer.closeAll('loading'); //关闭loading
		        	 // upload();   //重新上传
		        	  console.log("error");
		          }
		      });
})	    
</script>
</body>
</html>